<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>WhatDoWeDoNow!</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
        <script src="phaser.min.js"></script>
    </head>
<body>
    <div>TODO write content</div>

    <div id="middle">
        <div id="phaser_window"></div>
    </div>
        
<script>

    var play = play || {};
    play.game = new Phaser.Game(500, 500, Phaser.AUTO, 'phaser_window', { preload: preload, create: create, update: update });
    
    function preload() {
        this.game.load.image('square', 'purple_sq.png');
    }
    
    var player_group;
    
    var player;
    var player2;

    function create() {
        this.game.physics.startSystem(Phaser.Physics.ARCADE);
        
//        player_group = this.game.add.group()
//        player_group.enableBody = true;
//
//        player = player_group.create(100, 100, 'square');
//        player.body.collideWordBounds = true;
//        this.game.physics.arcade.enable(player);
//        player.body.bounce.y = 0.0;
//        player.body.gravity.y = 0;
//        
//        
//        player2 = player_group.create(300, 300, 'square');
//        
//        //play.game.physics.arcade.enable(player);
//        
//        //play.game.physics.arcade.enable(player2);
//        player2.body.collideWordBounds = true;
//        this.game.physics.arcade.enable(player2);

        setup_players();
    }
    
    function setup_players() {
        
        player_group = play.game.add.group();
        //player_group.enableBody = true;
        //play.game.physics.arcade.enable(player_group);
        //player_group.body.collideWorldBounds = true;
        
        player = player_group.create(100, 100, 'square');
        //player.
        player2 = player_group.create(300, 300, 'square');
        
        //player = play.game.add.sprite(100, 100, 'square');
        play.game.physics.arcade.enable(player);
        player.body.collideWorldBounds = true;
        
        //player2 = play.game.add.sprite(300, 300, 'square');
        play.game.physics.arcade.enable(player2);
        player2.body.collideWorldBounds = true;

        //player.animations.add('left', [0,1,2,3], 10, true);
        //player.animations.add('right', [5,6,7,8], 10, true);
        
        //RainGame.game.camera.follow(player);
    }
    
    function update() {
        //console.log("hej!");
        update_player1_movement();
        update_player2_movement();
        
        play.game.physics.arcade.collide(player, player2, this.death_handler, null, this);
    }
    
    function death_handler() {
        player.destroy();
        player2.destroy();
    }
    
    function update_player1_movement() {
        var cursors = play.game.input.keyboard.createCursorKeys();
        player.body.velocity.x = 0;
        player.body.velocity.y = 0;
        
        var speed = 150;
        
        if (cursors.right.isDown) {
            player.body.velocity.x = speed;
        }
        else if (cursors.left.isDown) {
            player.body.velocity.x = -speed;
        }
        else if (cursors.up.isDown) {
            player.body.velocity.y = -speed;
        }
        else if (cursors.down.isDown) {
            player.body.velocity.y = speed;
        }
    }
    
    function update_player2_movement() {
        //var cursors = play.game.input.keyboard.;
        var upKey = play.game.input.keyboard.addKey(Phaser.Keyboard.W);
        var leftKey = play.game.input.keyboard.addKey(Phaser.Keyboard.A);
        var rightKey = play.game.input.keyboard.addKey(Phaser.Keyboard.D);
        var downKey = play.game.input.keyboard.addKey(Phaser.Keyboard.S);

        player2.body.velocity.x = 0;
        player2.body.velocity.y = 0;
        
        var speed = 150;
        
        if (upKey.isDown) {
            player2.body.velocity.y = -speed;
        }
        else if (leftKey.isDown) {
            player2.body.velocity.x = -speed;
        }
        else if (rightKey.isDown) {
            player2.body.velocity.x = speed;
        }
        else if (downKey.isDown) {
            player2.body.velocity.y = speed;
        }
    }

</script>
</body>
</html>
